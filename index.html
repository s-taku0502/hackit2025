<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/index.css">
    <title>ホーム画面</title>
</head>

<body>
    <header class="header">
        <div>
            <img src="/img/hackit.png" alt="Hackit Logo" class="logo">
        </div>
        <nav class="nav">
            <ul>
                <li><a href="index.html">ホーム</a></li>
                <li><a href="/contributor/new.html">過去問投稿</a></li>
                <li><a href="/viewer/question/list.html">質問・返答</a></li>
                <li><a href="/login.html">ログイン</a></li>
            </ul>
        </nav>
    </header>
    <main class="main">
        <h1 class="username">ようこそ, ゲストさん!</h1>
        
        <h2 class="past-papers">過去問一覧</h2>
        <a href="/viewer/past_quesion/past_questions_all.html">
            <!--過去問の年度を選択!-->
            <img src="/img/pastpaper.png" alt="過去問一覧" class="pastpapers">
        </a>

        <h2 class="recent-q-and-a">最近のQ&A</h2>
        <a href="/viewer/question/list.html">
            <!--最近の質問を表示-->
            <img src="/img/Q&A.png" alt="最近のQ&A" class="recentQandA">
        </a>

        <h2 class="recommend-for-you">あなたへのオススメ</h2>
        <a href="/viewer/past_questions.html">
            <!--最近見た質問からランダムで表示-->
        <img src="/img/recent for you.png" alt="あなたへのオススメ" class="recent">
        </a>
    </main>

    <script type="module" src="firebase.js"></script>
    <script type="module">
      const usernameElement = document.querySelector('.username');

      window.onAuth(async (user) => {
        if (user) {
          // ユーザーがログインしている場合
          const userProfile = await window.getUserProfile(user.uid);
          if (userProfile.exists()) {
            usernameElement.textContent = `ようこそ, ${userProfile.data().username}さん!`;
          } else {
            // Firestoreにユーザー情報がない場合
            usernameElement.textContent = 'ようこそ, ユーザーさん!';
          }
        } else {
          // ユーザーがログインしていない場合
          window.location.href = '/login.html';
        }
      });
    </script>
</body>

</html>